---
title: "seq_alignment: Una función para la significación del alineamiento de secuencias"
author: "Laura Julià Melis"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{seq_alignment: Una función para la significación del alineamiento de secuencias}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

## 1. Introducción.

El paquete **seqBio** contiene un solo objeto, que es la función `seq_alignment()`. Esta función es útil para estudiar la significación del alineamiento de secuencias y para ello, reliza el cálculo de la probabilidad de que la puntuación del alineamiento ha sido obtenida por azar (aplicando la estrategia de *shuffling*).

## 2. Argumentos de seq_alignment(). 

La función `seq_alignment()` no tiene valores por defecto por lo que para ejecutarla, será **siempre** necesario dar valores a todos sus argumentos de entrada.

  # 2. Comprobación de los inputs:

  - `seq1:` Secuencia 1 en formato Fasta (objeto de tipo carácter).
  - `seq2:` Secuencia 2 en formato Fasta (objeto de tipo carácter).
  - `seq_type:` Tipo de secuencia: "protein" o "dna" (objeto de tipo carácter).
  - `seq_align:` Tipo de alineamiento: "local" o "global" (objeto de tipo carácter).
  - `mat:` Matriz de substitución: PAMn, BLOSUM, … Ver \code{data(package="Biostrings")} para ver todas las opciones disponibles.
  - `gap:` Puntuación Gap: Open penalty, extended penalty (objeto de tipo numérico: vector con dos valores).
  - `N:` Número de replicas (objeto de tipo numérico y entero).
  - `shuff:` Secuencia donde se hace shuffling: 1 o 2 (objeto de tipo numéricoy entero).
  
Cabe mencionar que la función hace una comprobación de las clases y los valores de los inputs, por lo que se obtendrá un `warning` cuando la clase, la longitud o los valores de uno o varios inputs no sean las correctas (las indicadas tanto sobre este párrafo como también en la ayuda de la función).

```{r, eval = FALSE}
#Comprobación de los inputs:
stopifnot(class(seq1) == "character", class(seq2) == "character",
          seq_type %in% c("protein", "dna"), seq_align  %in% c("local", "global"),
          class(gap) == "numeric", class(N) == "numeric", class(shuff) == "numeric",
          length(gap) == 2, length(N) == 1, shuff %in% c(1, 2))
```


## 3. Metodología.

En esta sección se pretende explicar, paso a paso, cómo se realizó la creación de la función y qué cálculos se computan internamente. 

#### 1. Lectura de las secuencias.

En primer lugar, se realiza la lectura de las dos secuencias, *seq1* y *seq2*, a través de la función `readDNAStringSet()` del paquete *Biostrings*.

```{r, eval = FALSE}
s1 = readDNAStringSet(seq1, "fasta")
s2 = readDNAStringSet(seq2, "fasta")
```

#### 2. Creación de una funcion de haga N shufflings.


#### 3. Alineamiento original (óptimo).

```{r, eval = FALSE}
S <- pairwiseAlignment(s1, s2, type = seq_align, substitutionMatrix = mat, 
                       gapOpening = gap[1], gapExtension = gap[2], scoreOnly = TRUE)  
```

#### 4. Shuffling.
#### 5. Cálculos.
  
**Media y desv estándar de las puntiaciones.**
  
**Estimación de los parámetros de la distribución Gumbel.**
  
**Estimación de K**

**Estandarización de la puntuación S**

**Probabilidad que un alineamiento de secuencias al azar tenga una puntuación superior a la obtenida por azar.**

## 4. *Output* de seq_alignment().

#### 4.1. Resultado gráfico

#### 4.2. Resultado numérico


## 5. Ejemplos.
This section shows how to use `linreg()` on a well known dataset such as iris.
```{r include=FALSE}
#hello
```

## Referencias.

* Creación de un paquete: <https://support.rstudio.com/hc/en-us/articles/200486488-Developing-Packages-with-RStudio>
* Viñetas: <http://r-pkgs.had.co.nz/vignettes.html>
* Alineamiento de sequencias: <https://a-little-book-of-r-for-bioinformatics.readthedocs.io/en/latest/src/chapter4.html>
* Significación estadística: documento *Significación_estadistica.pdf* de Atenea.